{% extends "base.html" %}

{% block title %}Withdraw - Telegram Group Marketplace{% endblock %}

{% block content %}
<div class="withdraw-container">
    <div class="card">
        <h2 style="text-align: center;">Withdraw Funds</h2>
        
        <div class="balance-display">${{ user.balance }}</div>
        <div class="sm" style="text-align: center; margin-bottom: 2rem;">Available Balance</div>
        
        <div class="wallet-info">
            <div class="sm">Withdrawal Method</div>
            <div><b>USDT ({{ network }})</b></div>
            
            <div class="sm" style="margin-top: 1rem;">Your Wallet Address</div>
            <div style="word-break: break-all;"><b>{{ user.usdt_wallet }}</b></div>
        </div>
        
        {% if user.balance >= min_amount %}
        <div class="notice">
            <div class="sm"><b>Withdrawal Process:</b></div>
            <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                <li class="sm">Minimum withdrawal: ${{ min_amount }}</li>
                <li class="sm">Processing time: 1-3 business days</li>
                <li class="sm">Funds sent to your registered USDT wallet</li>
                <li class="sm">You'll receive a transaction ID when processed</li>
            </ul>
        </div>
        
        <form method="post" action="/withdraw" style="margin-top: 1.5rem;">
            <input type="number" 
                   name="amount" 
                   class="inp" 
                   placeholder="Amount to withdraw" 
                   min="{{ min_amount }}" 
                   max="{{ user.balance }}" 
                   step="0.01" 
                   required>
            
            <button type="submit" class="btn" style="width: 100%;">
                Request Withdrawal
            </button>
        </form>
        {% else %}
        <div class="alert alert-error">
            Minimum withdrawal amount is ${{ min_amount }}. Keep selling to reach the minimum!
        </div>
        {% endif %}
        
        <div style="text-align: center; margin-top: 1rem;">
            <a href="/profile" class="btn-sec">Back to Profile</a>
        </div>
    </div>
    
    <!-- Pending Withdrawals -->
    {% if pending_withdrawals %}
    <div class="card">
        <h3>Pending Withdrawals</h3>
        {% for w in pending_withdrawals %}
        <div class="card sm flex">
            <div>
                <b>${{ w.amount_usdt }}</b>
                <div class="sm">{{ w.created_ts }}</div>
            </div>
            <span class="badge">{{ w.status }}</span>
        </div>
        {% endfor %}
    </div>
    {% endif %}
</div>
{% endblock %}